# Тестовые сценарии для маркетплейса

#### **FR-001: Фильтрация по ТТХ**
| **Test ID** | T-001                                                                 |
|-------------|-----------------------------------------------------------------------|
| **Requirement** | FR-001                                                               |
| **Scenario** | Поиск вала из стали 45 с Ø=50±0.1 мм по ГОСТ 8732-78                 |
| **Preconditions** | 1. Каталог содержит 10+ валов<br>2. Пользователь авторизован как инженер |
| **Test Steps** | **Given:** Открыт каталог "Валы"<br>**When:** Заданы фильтры:<br> - Материал: `Сталь 45`<br> - Диаметр: `50±0.1 мм`<br> - ГОСТ: `8732-78`<br>**Then:** Система отображает 3 позиции:<br> - Вал 50-С45 (ООО "Уралдеталь")<br> - Вал ГОСТ 8732-78 (ЗАО "Машзавод")<br> - Вал 50мм Ст45 (ИП Сидоров) |
| **Test Data** | Каталог: 15 позиций валов (5 из стали 45, 3 с Ø50±0.1 мм)            |
| **Pass Criteria** | 1. В результатах только 3 позиции<br>2. Все соответствуют ТТХ<br>3. Время отклика < 1.5 сек |
| **Environment** | STAGING (Chrome 116)                                                  |

---

#### **FR-006: Эскроу-платеж**
| **Test ID** | T-002                                                                 |
|-------------|-----------------------------------------------------------------------|
| **Requirement** | FR-006                                                               |
| **Scenario** | Блокировка средств до подтверждения приемки                          |
| **Preconditions** | 1. Заказ на 500 000 руб создан<br>2. Покупатель верифицирован        |
| **Test Steps** | **Given:** Покупатель перевел деньги на эскроу-счет<br>**When:** Поставщик отгрузил товар<br>**Then:**<br> - Средства заблокированы<br> - Статус заказа "В пути"<br><br>**When:** Через 14 дней нет подтверждения приемки<br>**Then:** Автоматический возврат средств покупателю |
| **Test Data** | Сумма: 500 000 руб<br>Товар: Подшипник 6308 (100 шт)                 |
| **Pass Criteria** | 1. Поставщик не может получить деньги до приемки<br>2. Возврат через 14 дней ±5 мин |
| **Environment** | PROD-like (тестовый платежный шлюз)                                  |

---

#### **FR-008: Генерация документов 44-ФЗ**
| **Test ID** | T-003                                                                 |
|-------------|-----------------------------------------------------------------------|
| **Requirement** | FR-008                                                               |
| **Scenario** | Формирование протокола аукциона для госзакупок                       |
| **Preconditions** | 1. Заказ с типом "Госзакупка"<br>2. 3 поставщика подали предложения |
| **Test Steps** | **Given:** Завершен прием заявок<br>**When:** Система генерирует протокол<br>**Then:**<br> - Создается файл `Протокол_№123.xlsx`<br> - Включает поля: <br> &emsp;• Наименование поставщика<br> &emsp;• Цена<br> &emsp;• Сроки<br> - Подписан ЭЦП площадки |
| **Test Data** | Поставщики: ООО "Спецсталь", АО "Тяжмаш", ИП Петров                 |
| **Pass Criteria** | 1. Файл соответствует схеме ФНС<br>2. ЭЦП валидна в Контур.Крипто<br>3. Данные поставщиков точны |
| **Environment** | DEV (1С:Документооборот)                                             |

---

#### **PERF-001: Скорость загрузки каталога**
| **Test ID** | T-004                                                                 |
|-------------|-----------------------------------------------------------------------|
| **Requirement** | PERF-001                                                             |
| **Scenario** | Загрузка каталога под нагрузкой 1 000 RPM                           |
| **Preconditions** | Развернута тестовая среда с 50 000 товаров                           |
| **Test Steps** | **Given:** Настройка JMeter сценария:<br> - 200 виртуальных пользователей<br> - Ramp-up: 60 сек<br>**When:** Запуск теста<br>**Then:**<br> - 95% запросов завершаются ≤2 сек<br> - Ошибок 0% |
| **Test Data** | Категория: "Подшипники" (15 000 позиций)                             |
| **Pass Criteria** | 1. p95 latency ≤ 2000 мс<br>2. Error rate = 0%<br>3. CPU сервера ≤80% |
| **Environment** | Load Zone (Yandex.Cloud)                                             |

---

#### **SEC-004: Защита КП**
| **Test ID** | T-005                                                                 |
|-------------|-----------------------------------------------------------------------|
| **Requirement** | FR-004                                                               |
| **Scenario** | Попытка скачивания конфиденциального КП неверифицированным пользователем |
| **Preconditions** | 1. КП помечено как "Конфиденциально"<br>2. Пользователь без верификации |
| **Test Steps** | **Given:** Пользователь открывает карточку КП<br>**When:** Нажимает "Скачать"<br>**Then:**<br> - Система блокирует скачивание<br> - Отображает сообщение: "Доступ ограничен"<br> - В security.log фиксируется попытка доступа |
| **Test Data** | КП "Технология литья_ООО Стальмет"                                   |
| **Pass Criteria** | 1. Файл не скачан<br>2. Security alert отправлен администратору<br>3. HTTP-код 403 |
| **Environment** | PROD (с тестовым КП)                                                 |

---

### Почему такой формат соответствует стандартам?
1. **Полное покрытие BDD**:
   - Четкие шаги `Given/When/Then` (ISO 29119 Part 3)
   - Измеримые критерии (IEEE 829-2008)

2. **Примеры из практики промышленного ПО**:
   ```gherkin
   // Стандарт Gherkin для ERP-систем (SAP)
   Scenario: Material Requirements Planning
     Given 50 000 items in catalog
     When user searches "GOST 8732-78 steel"
     Then system shows ≤200 results in <3 sec
   ```

3. **Поддержка инструментов**:
   ```markdown
   | Инструмент       | Стандарт       |
   |------------------|----------------|
   | Selenium BDD     | Gherkin        |
   | JMeter           | JMX + CSV data |
   | OWASP ZAP        | OWASP ASVS     |
   ```

4. **Трассируемость**:
   ```mermaid
   graph LR
     A[BR-003: Сокращение времени поиска] --> B[FR-001: Фильтр по ТТХ]
     B --> C[T-001: Тест фильтрации]
     C --> D[JIRA: QA-205]
   ```

Для MVP рекомендую **15-20 ключевых сценариев** с фокусом на:
1. Фильтрацию по ГОСТ/ТТХ (FR-001)
2. Платежи и эскроу (FR-006)
3. Интеграцию с 1С (FR-005)
4. Безопасность документов (SEC-004)

[Пример полного тест-кейса по ГОСТ Р 57193-2016](https://docs.cntd.ru/document/1200121155)